#!/usr/bin/env python3
"""Wrapper script for usage-bar monitor."""
import sys
from pathlib import Path

# Determine where to look for python-src
script_path = Path(__file__).resolve()
script_dir = script_path.parent

# Search paths in priority order
search_paths = [
    # Development: relative to script location
    script_dir / "python-src",
    script_dir.parent / "python-src",
    # Installed: relative to PREFIX
    script_dir.parent / "share" / "usage-bar" / "python-src",
    Path("/usr/local/share/usage-bar/python-src"),
    Path("/usr/share/usage-bar/python-src"),
    # If installed in ~/.local/bin
    script_dir.parent / "share" / "usage-bar" / "python-src",
]

python_src = None
for path in search_paths:
    if path.exists() and (path / "main.py").exists():
        python_src = path
        break

if python_src is None:
    print(f"Error: Could not find python-src directory", file=sys.stderr)
    print(f"Searched in:", file=sys.stderr)
    for path in search_paths:
        print(f"  {path}", file=sys.stderr)
    sys.exit(1)

sys.path.insert(0, str(python_src))

from main import main

if __name__ == "__main__":
    sys.exit(main())
